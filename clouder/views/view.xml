<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <data>

        <menuitem id="menu_clouder" name="Clouder" sequence="40"/>

        <menuitem id="menu_clouder_clouder" name="Clouder" parent="menu_clouder" sequence="5"/>



        <record id="action_clouder_environment_form" model="ir.actions.act_window">
            <field name="name">Environments</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">clouder.environment</field>
            <field name="view_type">form</field>
        </record>

        <menuitem action="action_clouder_environment_form" id="menu_action_clouder_environment_form" parent="menu_clouder_clouder"/>

        <record id="view_clouder_environment_form" model="ir.ui.view">
            <field name="name">clouder.environment.form</field>
            <field name="model">clouder.environment</field>
            <field name="arch" type="xml">
                <form string="Base" version="7.0">
                    <group col="4">
                        <field name="name"/>
                        <field name="partner_id"/>
                        <field name="prefix"/>
                        <newline/>
                        <field name="user_ids"/>
                        <field name="service_ids"/>
                    </group>
                </form>
            </field>
        </record>
        <record id="view_clouder_environment_tree" model="ir.ui.view">
            <field name="name">clouder.environment.tree</field>
            <field name="model">clouder.environment</field>
            <field name="arch" type="xml">
                <tree string="Base">
                        <field name="name"/>
                        <field name="partner_id"/>
                        <field name="prefix"/>
                </tree>
            </field>
        </record>


        <record id="action_clouder_base_form" model="ir.actions.act_window">
            <field name="name">Bases</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">clouder.base</field>
            <field name="view_type">form</field>
        </record>

        <menuitem action="action_clouder_base_form" id="menu_action_clouder_base_form" parent="menu_clouder_clouder"/>

        <record id="view_clouder_base_form" model="ir.ui.view">
            <field name="name">clouder.base.form</field>
            <field name="model">clouder.base</field>
            <field name="arch" type="xml">
                <form string="Base" version="7.0">
                    <group col="4">
                        <field name="name"/>
                        <field name="domain_id"/>
                        <field name="environment_id"/>
                        <field name="title"/>
                        <field name="application_id" domain="[('base','=',True)]"/>
                        <field name="service_id" required="0" domain="[('application_id.base', '=', True)]"/>
                        <field name="admin_name"/>
                        <field name="admin_password"/>
                        <field name="admin_email"/>
                        <field name="poweruser_name"/>
                        <field name="poweruser_password"/>
                        <field name="poweruser_email"/>
                        <field name="build"/>
                        <field name="lang"/>
                        <field name="ssl_only"/>
                        <field name="auto_backup"/>
                        <field name="test"/>
                        <field name="reset_each_day"/>
                        <newline/>
                        <field name="public"/>
                    </group>
                    <group col="4">
                        <field name="cert_key"/>
                        <field name="cert_cert"/>
                        <field name="cert_renewal_date" attrs="{'invisible': [('cert_renewal_date','=',False)]}"/>
                    </group>
                    <group col="2">
                        <button name="generate_cert" string="Generate Certs" type="object" attrs="{'invisible': ['|','|',('cert_key','!=',False),('cert_cert','!=',False),('cert_renewal_date','!=',False)]}"/>
                        <button name="renew_cert" string="Renewal Certs" type="object" attrs="{'invisible': [('cert_renewal_date','=',False)]}"/>
                    </group>
                    <group col="3">
                        <field name="reset_id"/>
                        <button name="reset_base" string="Reset from parent" type="object" attrs="{'invisible': [('reset_id','=',False)]}"/>
                    </group>
                    <notebook>
                        <page string="General">
                            <field name="option_ids" colspan="4">
                                <tree string="Options" editable="bottom">
                                    <field name="name" domain="[('application_type_id.application_ids.service_ids','in',parent.service_id),('type','=','base')]"/>
                                    <field name="value"/>
                                </tree>
                            </field>
                            <field name="link_ids" colspan="4">
                                <tree string="Links" editable="bottom">
                                    <field name="name"/>
                                    <field name="target" domain="[('application_id','=',name)]"/>
                                    <field name="required"/>
                                    <field name="auto"/>
                                    <field name="deployed"/>
                                    <button name="deploy_" type="object" string="Reload"/>
                                    <button name="purge_" type="object" string="Purge"/>
                                </tree>
                            </field>
                            <field name="child_ids" colspan="4">
                                <tree string="Childs" editable="bottom">
                                    <field name="name"/>
                                    <field name="sequence"/>
                                    <field name="domainname"/>
                                    <field name="domain_id" attrs="{'required': [('domainname', '!=', False)]}"/>
                                    <field name="service_id" attrs="{'readonly': [('child_id','!=', False)]}"/>
                                    <field name="child_id"/>
                                    <field name="backup_id"/>
                                    <button name="create_child" type="object" string="Deploy" attrs="{'invisible': [('child_id','!=', False)]}"/>
                                    <button name="delete_child" type="object" string="Purge" attrs="{'invisible': [('child_id','=', False)]}"/>
                                </tree>
                            </field>
                            <button name="compute_childs" string="Compute links between childs" type="object" attrs="{'invisible': [('child_ids', '=', [])]}"/>
                            <newline/>
                            <button name="reinstall" string="Reinstall" type="object"/>
                            <button name="purge" string="Purge" type="object"/>
                            <button name="update" string="Update" type="object"/>
                            <field name="job_ids" colspan="4"/>
                        </page>
                        <page name="backup" string="Backup">
                            <group col="4">
                                <field name="backup_ids" widget="many2many_tags" domain="[('application_id.type_id.name','=','backup')]"/>
                                <field name="time_between_backup"/>
                                <field name="backup_expiration"/>
                                <newline/>
                                <field name="date_next_backup"/>
                                <field name="backup_comment"/>
                            </group>
                            <button name="backup" string="Backup" type="object"/>
                        </page>
                        <page string="Metadata">
                            <field name="metadata_ids" colspan="4">
                                <tree string="Metadata" readonly="1">
                                    <field name="name"/>
                                    <field name="value_data"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>
        <record id="view_clouder_base_tree" model="ir.ui.view">
            <field name="name">clouder.base.tree</field>
            <field name="model">clouder.base</field>
            <field name="arch" type="xml">
                <tree string="Base">
                        <field name="name"/>
                        <field name="domain_id"/>
                        <field name="state"/>
                </tree>
            </field>
        </record>


        <record id="action_clouder_service_form" model="ir.actions.act_window">
            <field name="name">Services</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">clouder.service</field>
            <field name="domain">[]</field>
            <field name="context">{'search_default_root': 1}</field>
            <field name="view_type">form</field>
        </record>

        <menuitem action="action_clouder_service_form" id="menu_action_clouder_service_form" parent="menu_clouder_clouder"/>

        <record id="view_clouder_service_form" model="ir.ui.view">
            <field name="name">clouder.service.form</field>
            <field name="model">clouder.service</field>
            <field name="arch" type="xml">
                <form string="Service" version="7.0">
                    <group col="4">
                        <field name="name"/>
                        <newline/>
                        <field name="environment_id"/>
                        <field name="suffix"/>
                        <field name="application_id"/>
                        <field name="node_id"/>
                        <field name="image_id" attrs="{'invisible': [('child_ids','!=', [])], 'required': [('child_ids','=', [])]}"/>
                        <field name="image_version_id" domain="[('image_id','=',image_id)]" attrs="{'invisible': [('child_ids','!=', [])]}"/>
                        <newline/>
                        <field name="volumes_from_ids" widget="many2many_tags"/>
                        <field name="public"/>
                        <field name="scale"/>
                        <field name="from_id" attrs="{'invisible': [('from_id','=', False)]}"/>
                        <field name="dummy"/>
                        <field name="provider_id"/>
                    </group>
                    <notebook>
                        <page string="General">
                            <field name="option_ids" colspan="4">
                                <tree string="Options" editable="bottom">
                                    <field name="name" domain="[('application_type_id.application_ids','in',parent.application_id),('type','=','service'),('tag_ids.application_ids','in',parent.application_id)]"/>
                                    <field name="value"/>
                                </tree>
                            </field>
                            <field name="port_ids" colspan="4" attrs="{'invisible': [('child_ids','!=', [])]}">
                                <tree string="Ports" editable="bottom">
                                    <field name="name"/>
                                    <field name="local_port"/>
                                    <field name="hostport"/>
                                    <field name="expose"/>
                                    <field name="udp"/>
                                    <field name="use_hostport"/>
                                </tree>
                            </field>
                            <field name="volume_ids" colspan="4" attrs="{'invisible': [('child_ids','!=', [])]}">
                                <tree string="Volumes" editable="bottom">
                                    <field name="name"/>
                                    <field name="localpath"/>
                                    <field name="hostpath"/>
                                    <field name="user"/>
                                    <field name="readonly"/>
                                    <field name="no_backup"/>
                                </tree>
                            </field>
                            <field name="link_ids" colspan="4">
                                <tree string="Links" editable="bottom">
                                    <field name="name"/>
                                    <field name="target" domain="[('application_id','=',name)]"/>
                                    <field name="required"/>
                                    <field name="auto"/>
                                    <field name="make_link"/>
                                    <field name="deployed"/>
                                    <button name="deploy_" type="object" string="Reload"/>
                                    <button name="purge_" type="object" string="Purge"/>
                                </tree>
                            </field>
                            <field name="child_ids" colspan="4">
                                <tree string="Childs" editable="bottom">
                                    <field name="name"/>
                                    <field name="sequence"/>
                                    <field name="node_id" attrs="{'readonly': [('child_id','!=', False)]}"/>
                                    <field name="child_id"/>
                                    <field name="backup_id"/>
                                    <button name="create_child" type="object" string="Deploy" attrs="{'invisible': [('child_id','!=', False)]}"/>
                                    <button name="delete_child" type="object" string="Purge" attrs="{'invisible': [('child_id','=', False)]}"/>
                                </tree>
                            </field>
                            <button name="reinstall" string="Reinstall" type="object"/>
                            <button name="purge" string="Purge" type="object"/>
                            <button name="update" string="Update" type="object"/>
                            <newline/>
                            <button name="start" string="Restart" type="object"/>
                            <button name="stop" string="Stop" type="object"/>
                            <newline/>
                            <field name="job_ids" colspan="4"/>
                        </page>
                        <page string="Reset" attrs="{'invisible': [('from_id','!=', False)]}">
                            <group col="4">
                                <field name="reset_base_ids"/>
                                <newline/>
                                <field name="subservice_name"/>
                                <button name="install_subservice" string="Install Subservice" type="object"/>
                            </group>
                        </page>
                        <page name="backup" string="Backup">
                            <group col="4">
                                <field name="backup_ids" widget="many2many_tags" domain="[('application_id.type_id.name','=','backup')]"/>
                                <field name="auto_backup"/>
                                <field name="time_between_backup"/>
                                <field name="backup_expiration"/>
                                <newline/>
                                <field name="date_next_backup"/>
                                <field name="backup_comment"/>
                            </group>
                            <button name="backup" string="Backup" type="object"/>
                        </page>
                        <page string="Metadata">
                            <field name="metadata_ids" colspan="4">
                                <tree string="Metadata" readonly="1">
                                    <field name="name"/>
                                    <field name="value_data"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>


                </form>
            </field>
        </record>
        <record id="view_clouder_service_tree" model="ir.ui.view">
            <field name="name">clouder.service.tree</field>
            <field name="model">clouder.service</field>
            <field name="arch" type="xml">
                <tree string="Services">
                    <field name="name"/>
                    <field name="node_id"/>
                    <field name="application_id"/>
                    <field name="image_id"/>
                    <field name="image_version_id"/>
                    <field name="ports_string"/>
                </tree>
            </field>
        </record>
        <record id="view_clouder_service_filter" model="ir.ui.view">
            <field name="name">clouder.service.filter</field>
            <field name="model">clouder.service</field>
            <field name="arch" type="xml">
                <search string="Services">
                    <field name="name"/>
                    <filter name="root" string="Root" domain="[('parent_id', '=', False)]"/>
                </search>
            </field>
        </record>


        <record id="action_clouder_node_form" model="ir.actions.act_window">
            <field name="name">Nodes</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">clouder.node</field>
            <field name="view_type">form</field>
        </record>

        <menuitem action="action_clouder_node_form" id="menu_action_clouder_node_form" parent="menu_clouder_clouder"/>

        <record id="view_clouder_node_form" model="ir.ui.view">
            <field name="name">clouder.node.form</field>
            <field name="model">clouder.node</field>
            <field name="arch" type="xml">
                <form string="Node" version="7.0">
                    <group col="4">
                        <field name="name"/>
                        <field name="domain_id"/>
                        <field name="public_ip" attrs="{'invisible':[('runner_id','!=',False)], 'required':[('runner_id','=',False)]}"/>
                        <field name="private_ip" attrs="{'invisible':[('runner_id','!=',False)], 'required':[('runner_id','=',False)]}"/>
                        <field name="login" attrs="{'invisible':[('runner_id','!=',False)]}"/>
                        <field name="ssh_port" attrs="{'invisible':[('runner_id','!=',False)], 'required':[('runner_id','=',False)]}"/>
                        <field name="environment_id"/>
                        <field name="manager"/>
                        <field name="provider_id" domain="[('type','in',['node','service'])]"/>
                    </group>
                    <notebook>
                        <page string="General">
                            <group col="4">
                                <field name="private_key" attrs="{'invisible':[('runner_id','!=',False)], 'required':[('runner_id','=',False)]}"/>
                                <field name="public_key" attrs="{'invisible':[('runner_id','!=',False)], 'required':[('runner_id','=',False)]}"/>
                                <field name="start_port"/>
                                <field name="end_port"/>
                                <field name="assign_ip"/>
                                <field name="public"/>
                                <field name="supervision_id"/>
                                <field name="runner_id" widget="selection"/>
                                <newline/>
                                <field name="salt_minion_id"/>
                                <field name="control_dns"/>
                            </group>
                            <button name="reinstall" string="Reinstall" type="object"/>
                            <button name="purge" string="Purge" type="object"/>
                            <button name="configure" string="Configure" type="object"/>
                            <button name="test_connection" string="Test connection" type="object"/>
                            <button name="start_services" string="Restart Services" type="object"/>
                            <button name="stop_services" string="Stop Services" type="object"/>
                            <button name="deploy_dns" string="Reinstall DNS" type="object"/>
                            <button name="purge_dns" string="Purge DNS" type="object"/>
                            <button name="clean" string="Clean disk space" type="object"/>
                            <newline/>
                            <group col="4">
                                <field name="oneclick_ids" widget="many2many_tags"/>
                                <field name="oneclick_ports" attrs="{'invisible': [('oneclick_ids','=',[])]}"/>
                                <newline/>
                                <button name="oneclick_deploy" string="Deploy" type="object" attrs="{'invisible': [('oneclick_ids','=',[])]}"/>
                                <button name="oneclick_purge" string="Purge" type="object" attrs="{'invisible': [('oneclick_ids','=',[])]}"/>
                            </group>
                            <field name="job_ids" colspan="4"/>
                        </page>
                        <page string="LibCloud" attrs="{'invisible': [('provider_id','=',False)]}">
                            <group>
                                <field name="libcloud_image"/>
                                <field name="libcloud_size"/>
                                <field name="libcloud_location"/>
                                <newline/>
                                <field name="libcloud_name"/>
                                <field name="libcloud_state"/>
                                <newline/>
                                <button name="libcloud_create" string="Create" type="object"/>
                                <button name="libcloud_destroy" string="Destroy" type="object"/>
                                <button name="libcloud_reboot" string="Reboot" type="object"/>
                                <button name="libcloud_stop" string="Stop" type="object"/>
                            </group>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>
        <record id="view_clouder_node_tree" model="ir.ui.view">
            <field name="name">clouder.node.tree</field>
            <field name="model">clouder.node</field>
            <field name="arch" type="xml">
                <tree string="Nodes">
                    <field name="name"/>
                    <field name="domain_id"/>
                    <field name="runner_id"/>
                    <field name="public_ip"/>
                    <field name="private_ip"/>
                    <field name="ssh_port"/>
                </tree>
            </field>
        </record>

        <record id="action_clouder_backup_form" model="ir.actions.act_window">
            <field name="name">Backups</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">clouder.backup</field>
            <field name="view_type">form</field>
        </record>

        <menuitem action="action_clouder_backup_form" id="menu_action_clouder_backup_form" parent="menu_clouder_clouder"/>

        <record id="view_clouder_backup_form" model="ir.ui.view">
            <field name="name">clouder.backup.form</field>
            <field name="model">clouder.backup</field>
            <field name="arch" type="xml">
                <form string="Backup" version="7.0">
                    <group col="4">
                      <field name="name"/>
                      <field name="backup_id"/>
                      <field name='comment'/>
                      <field name="now_bup"/>
                      <field name="date_expiration"/>
                    </group>
                    <notebook>
                        <page string="Service">
                            <group col="4">
                                <field name="service_id"/>
                                <field name="service_fullname"/>
                                <field name="service_app"/>
                                <field name="service_img"/>
                                <field name="service_img_version"/>
                                <field name="service_ports"/>
                                <field name="service_options"/>
                                <field name="service_links"/>
                                <field name="service_volumes_comma"/>
                                <field name="service_volumes"/>
                            </group>
                       </page>
                        <page string="Base" attrs="{'invisible':[('base_fullname','=',False)]}">
                            <group col="4">
                                <field name="base_id"/>
                                <field name="base_fullname"/>
                                <field name="base_title"/>
                                <field name="base_admin_name"/>
                                <field name="base_admin_password"/>
                                <field name="base_admin_email"/>
                                <field name="base_poweruser_name"/>
                                <field name="base_poweruser_password"/>
                                <field name="base_poweruser_email"/>
                                <field name="base_build"/>
                                <field name="base_test"/>
                                <field name="base_lang"/>
                                <field name="base_auto_backup"/>
                                <field name="base_options"/>
                                <field name="base_links"/>
                            </group>
                       </page>
                    </notebook>
                    <group col="4">
                      <separator string="Restore"/>
                      <newline/>
                      <field name="environment"/>
                      <newline/>
                      <field name="service_suffix" attrs="{'invisible':[('base_id','!=',False)]}"/>
                      <field name="service_node" attrs="{'invisible':[('base_id','!=',False)]}"/>
                      <field name="base_service_suffix" readonly="1" attrs="{'invisible':[('base_id','=',False)]}"/>
                      <field name="base_service_node" readonly="1" attrs="{'invisible':[('base_id','=',False)]}"/>
                      <field name="base_name" attrs="{'invisible':[('base_id','=',False)]}"/>
                      <field name="base_domain" attrs="{'invisible':[('base_id','=',False)]}"/>
                      <field name="restore_to_environment_id"/>
                      <newline/>
                      <field name="service_restore_to_suffix"/>
                      <field name="service_restore_to_node_id"/>
                      <field name="base_restore_to_name" attrs="{'invisible':[('base_id','=',False)]}"/>
                      <field name="base_restore_to_domain_id" attrs="{'invisible':[('base_id','=',False)]}"/>
                    </group>
                    <button name="restore" string="Restore" type="object"/>
                    <field name="job_ids" colspan="4"/>
                </form>
            </field>
        </record>
        <record id="view_clouder_backup_tree" model="ir.ui.view">
            <field name="name">clouder.backup.tree</field>
            <field name="model">clouder.backup</field>
            <field name="arch" type="xml">
                <tree string="Backup">
                    <field name="name"/>
                    <field name='service_fullname' attrs="{'invisible': [('base_fullname','!=',False)]}"/>
                    <field name='base_fullname'/>
                    <field name='comment'/>
                    <field name='date_expiration'/>
                </tree>
            </field>
        </record>

        <record id="view_clouder_job_form" model="ir.ui.view">
            <field name="name">clouder.job.form</field>
            <field name="model">clouder.job</field>
            <field name="arch" type="xml">
                <form string="Job" version="7.0">
                    <header>
                        <field name="state" widget="statusbar" statusbar_visible="started,done,failed"/>
                    </header>
                    <group>
                        <group>
                            <field name="name"/>
                            <field name='model_name'/>
                            <field name='start_date'/>
                        </group>
                        <group>
                            <field name="action"/>
                            <field name="res_id"/>
                            <field name="end_date"/>
                        </group>
                    </group>
                    <field name="log" colspan="4" nolabel="1"/>
                </form>
            </field>
        </record>
        <record id="view_clouder_job_tree" model="ir.ui.view">
            <field name="name">clouder.job.tree</field>
            <field name="model">clouder.job</field>
            <field name="arch" type="xml">
                <tree string="Job" colors="red:state == 'failed';gray:state == 'done'">
                    <field name="name"/>
                    <field name="action"/>
                    <field name='model_name'/>
                    <field name="create_date"/>
                    <field name="create_uid"/>
                    <field name='start_date'/>
                    <field name='end_date'/>
                    <field name='state'/>
                </tree>
            </field>
        </record>


        <menuitem id="menu_clouder_configuration" name="Configuration" parent="menu_clouder" sequence="10"/>

        <record id="action_clouder_domain_form" model="ir.actions.act_window">
            <field name="name">Domains</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">clouder.domain</field>
            <field name="view_type">form</field>
        </record>

        <menuitem action="action_clouder_domain_form" id="menu_action_clouder_domain_form" parent="menu_clouder_configuration"/>

        <record id="view_clouder_domain_form" model="ir.ui.view">
            <field name="name">clouder.domain.form</field>
            <field name="model">clouder.domain</field>
            <field name="arch" type="xml">
                <form string="Domain" version="7.0">
                    <group col="4">
                        <field name="name"/>
                        <field name="organisation"/>
                        <field name="dns_id"/>
                        <newline/>
                        <field name="cert_key"/>
                        <field name="cert_cert"/>
                        <field name="public"/>
                        <field name="partner_id"/>
                    </group>
                    <button name="reinstall" string="Reinstall" type="object"/>
                    <field name="job_ids" colspan="4"/>
                </form>
            </field>
        </record>
        <record id="view_clouder_domain_tree" model="ir.ui.view">
            <field name="name">clouder.domain.tree</field>
            <field name="model">clouder.domain</field>
            <field name="arch" type="xml">
                <tree string="Domains">
                    <field name="name"/>
                </tree>
            </field>
        </record>

        <record id="action_clouder_application_type_form" model="ir.actions.act_window">
            <field name="name">Application types</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">clouder.application.type</field>
            <field name="view_type">form</field>
        </record>

        <menuitem action="action_clouder_application_type_form" id="menu_action_clouder_application_type_form" parent="menu_clouder_configuration"/>

        <record id="view_clouder_application_type_form" model="ir.ui.view">
            <field name="name">clouder.application.type.form</field>
            <field name="model">clouder.application.type</field>
            <field name="arch" type="xml">
                <form string="Application type" version="7.0">
                    <group col="4">
                        <field name="name"/>
                        <field name="system_user"/>
                        <field name="symlink"/>
                        <field name="localpath"/>
                        <field name="localpath_services"/>
                        <field name="multiple_databases"/>
                        <field name="tag_ids" widget="many2many_tags"/>
                    </group>
                    <field name="option_ids" colspan="4">
                        <tree string="Options" editable="bottom">
                            <field name="name"/>
                            <field name="type"/>
                            <field name="tag_ids" widget="many2many_tags"/>
                            <field name="auto"/>
                            <field name="required"/>
                            <field name="default"/>
                        </tree>
                    </field>
                </form>
            </field>
        </record>
        <record id="view_clouder_application_type_tree" model="ir.ui.view">
            <field name="name">clouder.application.type.tree</field>
            <field name="model">clouder.application.type</field>
            <field name="arch" type="xml">
                <tree string="Application types">
                    <field name="name"/>
                    <field name="tag_ids"/>
                </tree>
            </field>
        </record>


        <record id="action_clouder_application_template_form" model="ir.actions.act_window">
            <field name="name">Application Templates</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">clouder.application.template</field>
            <field name="view_type">form</field>
        </record>

        <menuitem action="action_clouder_application_template_form" id="menu_action_clouder_application_template_form" parent="menu_clouder_configuration"/>

        <record id="view_clouder_application_template_form" model="ir.ui.view">
            <field name="name">clouder.application.template.form</field>
            <field name="model">clouder.application.template</field>
            <field name="arch" type="xml">
                <form string="Application Template" version="7.0">
                    <group col="4">
                        <field name="name"/>
                    </group>
                    <notebook>
                        <page string="General">
                            <field name="link_ids" colspan="4">
                                <tree string="Links" editable="bottom">
                                    <field name="name"/>
                                    <field name="required"/>
                                    <field name="auto"/>
                                    <field name="make_link"/>
                                    <field name="service"/>
                                    <field name="base"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>
        <record id="view_clouder_application_template_tree" model="ir.ui.view">
            <field name="name">clouder.application.template.tree</field>
            <field name="model">clouder.application.template</field>
            <field name="arch" type="xml">
                <tree string="Application Templates">
                    <field name="name"/>
                </tree>
            </field>
        </record>


        <record id="action_clouder_application_form" model="ir.actions.act_window">
            <field name="name">Applications</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">clouder.application</field>
            <field name="view_type">form</field>
        </record>

        <menuitem action="action_clouder_application_form" id="menu_action_clouder_application_form" parent="menu_clouder_configuration"/>

        <record id="view_clouder_application_form" model="ir.ui.view">
            <field name="name">clouder.application.form</field>
            <field name="model">clouder.application</field>
            <field name="arch" type="xml">
                <form string="Application" version="7.0">
                    <group col="4">
                        <field name="name"/>
                        <field name="template_ids" widget="many2many_tags"/>
                        <field name="type_id"/>
                        <field name="code"/>
                        <field name="current_version"/>
                        <field name="tag_ids" widget="many2many_tags"/>
                        <field name="base"/>
                        <newline/>
                        <field name="default_image_id"/>
                        <field name="next_image_version_id" domain="[('image_id','=',default_image_id)]"/>
                        <newline/>
                        <field name="next_node_id"/>
                        <field name="next_service_id" attrs="{'invisible': [('base','!=',True)]}" domain="[('application_id','=',id)]"/>
                        <newline/>
                        <newline/>
                        <field name="admin_name"/>
                        <field name="admin_email"/>
                        <field name="public"/>
                        <field name="partner_id"/>
                        <field name="sequence"/>
                        <field name="required"/>
                        <field name="update_strategy"/>
                        <field name="update_bases"/>
                        <field name="dummy"/>
                        <field name="provider"/>
                    </group>
                    <notebook>
                        <page string="General">
                            <field name="option_ids" colspan="4">
                                <tree string="Options" editable="bottom">
                                    <field name="name" domain="[('application_type_id','=',parent.type_id),('type','=','application')]"/>
                                    <field name="value"/>
                                </tree>
                            </field>
                            <field name="link_ids" colspan="4">
                                <tree string="Links" editable="bottom">
                                    <field name="name"/>
                                    <field name="required"/>
                                    <field name="auto"/>
                                    <field name="make_link"/>
                                    <field name="service"/>
                                    <field name="base"/>
                                    <field name="next" domain="[('application_id','=',name)]"/>
                                </tree>
                            </field>
                            <field name="child_ids" colspan="4">
                                <tree string="Childs">
                                    <field name="name"/>
                                    <field name="code"/>
                                    <field name="sequence"/>
                                    <field name="next_node_id"/>
                                </tree>
                            </field>
                        </page>
                        <page name="backup" string="Backup">
                            <group>
                                <field name="auto_backup"/>
                                <newline/>
                                <field name="service_backup_ids" widget="many2many_tags" domain="[('application_id.type_id.name','=','backup')]"/>
                                <field name="base_backup_ids" widget="many2many_tags" domain="[('application_id.type_id.name','=','backup')]"/>
                                <field name="service_time_between_backup"/>
                                <field name="base_time_between_backup"/>
                                <field name="service_backup_expiration"/>
                                <field name="base_backup_expiration"/>
                            </group>
                        </page>
                        <page name="metadata" string="Metadata">
                            <field name="metadata_ids" colspan="4">
                                <tree string="Metadata" editable="bottom">
                                    <field name="name"/>
                                    <field name="clouder_type"/>
                                    <field name="value_type"/>
                                    <field name="is_function"/>
                                    <field name="func_name"/>
                                    <field name="default_value"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                </form>
            </field>
        </record>
        <record id="view_clouder_application_tree" model="ir.ui.view">
            <field name="name">clouder.application.tree</field>
            <field name="model">clouder.application</field>
            <field name="arch" type="xml">
                <tree string="Applications" default_order="name">
                    <field name="name"/>
                    <field name="type_id"/>
                    <field name="code"/>
                    <field name="tag_ids" widget="many2many_tags"/>
                </tree>
            </field>
        </record>


        <record id="view_clouder_application_metadata_tree" model="ir.ui.view">
            <field name="name">clouder.application.metadata.tree</field>
            <field name="model">clouder.application.metadata</field>
            <field name="arch" type="xml">
                <tree string="Application Metadata">
                    <field name="application_id"/>
                    <field name="name"/>
                    <field name="clouder_type"/>
                    <field name="value_type"/>
                    <field name="is_function"/>
                    <field name="func_name"/>
                    <field name="default_value"/>
                </tree>
            </field>
        </record>
        <record id="view_clouder_application_metadata_form" model="ir.ui.view">
            <field name="name">clouder.application.metadata.form</field>
            <field name="model">clouder.application.metadata</field>
            <field name="arch" type="xml">
                <form string="Application Metadata" version="7.0">
                    <group col="4">
                        <field name="name"/>
                        <field name="application_id"/>
                        <newline/>
                        <field name="clouder_type"/>
                        <newline/>
                        <field name="value_type"/>
                        <field name="default_value"/>
                        <newline/>
                        <field name="is_function"/>
                        <field name="func_name" attrs="{'invisible': [('is_function','=', False)], 'required': [('is_function','=', True)]}"/>
                    </group>
                </form>
            </field>
        </record>

        <record id="action_clouder_image_template_form" model="ir.actions.act_window">
            <field name="name">Images Templates</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">clouder.image.template</field>
            <field name="view_type">form</field>
        </record>

        <menuitem action="action_clouder_image_template_form" id="menu_action_clouder_image_template_form" parent="menu_clouder_configuration"/>

        <record id="view_clouder_image_template_form" model="ir.ui.view">
            <field name="name">clouder.image.template.form</field>
            <field name="model">clouder.image.template</field>
            <field name="arch" type="xml">
                <form string="Image" version="7.0">
                    <group col="4">
                        <field name="name"/>
                    </group>
                    <field name="volume_ids" colspan="4">
                        <tree string="Volumes" editable="bottom">
                            <field name="name"/>
                            <field name="localpath"/>
                            <field name="hostpath"/>
                            <field name="user"/>
                            <field name="readonly"/>
                            <field name="no_backup"/>
                        </tree>
                    </field>
                    <field name="port_ids" colspan="4">
                        <tree string="Ports" editable="bottom">
                            <field name="name"/>
                            <field name="local_port"/>
                            <field name="expose"/>
                            <field name="udp"/>
                            <field name="use_hostport"/>
                        </tree>
                    </field>
                </form>
            </field>
        </record>
        <record id="view_clouder_image_template_tree" model="ir.ui.view">
            <field name="name">clouder.image.template.tree</field>
            <field name="model">clouder.image.template</field>
            <field name="arch" type="xml">
                <tree string="Images">
                    <field name="name"/>
                </tree>
            </field>
        </record>

        <record id="action_clouder_image_form" model="ir.actions.act_window">
            <field name="name">Images</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">clouder.image</field>
            <field name="view_type">form</field>
        </record>

        <menuitem action="action_clouder_image_form" id="menu_action_clouder_image_form" parent="menu_clouder_configuration"/>

        <record id="view_clouder_image_form" model="ir.ui.view">
            <field name="name">clouder.image.form</field>
            <field name="model">clouder.image</field>
            <field name="arch" type="xml">
                <form string="Image" version="7.0">
                    <group col="4">
                        <field name="name"/>
                        <field name="type_id"/>
                        <field name="template_ids" widget="many2many_tags"/>
                        <field name="parent_id"/>
                        <field name="public"/>
                        <field name="partner_id"/>
                        <field name="volumes_from"/>
                    </group>
                    <field name="dockerfile" colspan="4"/>
                    <field name="volume_ids" colspan="4">
                        <tree string="Volumes" editable="bottom">
                            <field name="name"/>
                            <field name="localpath"/>
                            <field name="hostpath"/>
                            <field name="user"/>
                            <field name="readonly"/>
                            <field name="no_backup"/>
                        </tree>
                    </field>
                    <field name="port_ids" colspan="4">
                        <tree string="Ports" editable="bottom">
                            <field name="name"/>
                            <field name="local_port"/>
                            <field name="expose"/>
                            <field name="udp"/>
                            <field name="use_hostport"/>
                        </tree>
                    </field>
                    <group col="4">
                        <field name="parent_version_id" domain="[('image_id','=',parent_id)]" attrs="{'invisible': [('parent_id','=',False)],'required': [('parent_id','!=',False)]}"/>
                        <field name="parent_from" attrs="{'invisible': [('parent_id','!=',False)],'required': [('parent_id','=',False)]}"/>
                        <field name="registry_id" domain="[('application_id.type_id.tag_ids.name','=','registry'),('application_id.child_ids','!=',False)]"/>
                    </group>
                    <button name="build" string="Build" type="object"/>
                    <field name="version_ids" colspan="4"/>
                </form>
            </field>
        </record>
        <record id="view_clouder_image_tree" model="ir.ui.view">
            <field name="name">clouder.image.tree</field>
            <field name="model">clouder.image</field>
            <field name="arch" type="xml">
                <tree string="Images">
                    <field name="name"/>
                </tree>
            </field>
        </record>


        <record id="action_clouder_image_version_form" model="ir.actions.act_window">
            <field name="name">Image Versions</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">clouder.image.version</field>
            <field name="view_type">form</field>
        </record>

        <menuitem action="action_clouder_image_version_form" id="menu_action_clouder_image_version_form" parent="menu_clouder_configuration"/>

        <record id="view_clouder_image_version_form" model="ir.ui.view">
            <field name="name">clouder.image.version.form</field>
            <field name="model">clouder.image.version</field>
            <field name="arch" type="xml">
                <form string="Image Version" version="7.0">
                    <group col="4">
                        <field name="name"/>
                        <field name="image_id"/>
                        <field name="parent_id"/>
                        <field name="registry_id"/>
                    </group>
                    <field name="job_ids" colspan="4"/>
                </form>
            </field>
        </record>
        <record id="view_clouder_image_version_tree" model="ir.ui.view">
            <field name="name">clouder.image.version.tree</field>
            <field name="model">clouder.image.version</field>
            <field name="arch" type="xml">
                <tree string="Image Versions">
                    <field name="image_id"/>
                    <field name="name"/>
                    <field name="registry_id"/>
                    <field name="service_ids"/>
                </tree>
            </field>
        </record>

        <record id="view_clouder_provider_form" model="ir.ui.view">
            <field name="name">clouder.provider.form</field>
            <field name="model">clouder.provider</field>
            <field name="arch" type="xml">
                <form string="Provider" version="7.0">
                    <group col="4">
                        <field name="name"/>
                        <field name="type"/>
                        <field name="login"/>
                        <field name="secret_key"/>
                        <field name="smtp_relayhost" attrs="{'invisible': [('type','!=', 'smtp')]}"/>
                    </group>
                </form>
            </field>
        </record>
        <record id="view_clouder_provider_tree" model="ir.ui.view">
            <field name="name">clouder.provider.tree</field>
            <field name="model">clouder.provider</field>
            <field name="arch" type="xml">
                <tree string="Providers">
                    <field name="name"/>
                    <field name="type"/>
                </tree>
            </field>
        </record>


        <record id="view_clouder_configuration" model="ir.ui.view">
            <field name="name">clouder settings</field>
            <field name="model">clouder.config.settings</field>
            <field name="arch" type="xml">
                <form string="Application" version="7.0">
                    <group col="4">
                        <field name="email_sysadmin" required="1"/>
                        <newline/>
                        <field name="master_id"/>
                        <field name="salt_master_id"/>
                        <field name="runner"/>
                        <field name="runner_id" attrs="{'invisible': [('runner','!=','custom')], 'required=': [('runner','!=','custom')]}"/>
                        <newline/>
                        <field name="compose"/>
                        <field name="executor"/>
                        <newline/>
                        <field name="end_backup_all"/>
                        <field name="end_update_services"/>
                        <field name="end_reset_bases"/>
                        <field name="end_certs_renewal"/>
                    </group>
                    <button name="cron_daily" string="Launch daily cron" type="object"/>
                    <button name="backup_all" string="Backup All" type="object"/>
                    <button name="purge_expired_backups" string="Purge expired Backups" type="object"/>
                    <button name="update_services" string="Update services" type="object"/>
                    <button name="reset_bases" string="Reset Bases" type="object"/>
                    <button name="certs_renewal" string="Certs Renewal" type="object"/>
                    <button name="launch_next_backups" string="Launch Next Backups" type="object"/>
                    <button name="reset_all_jobs" string="Reset Jobs" type="object"/>
                    <group col="4">
                        <field name="provider_ids" colspan="4"/>
                    </group>
                    <field name="job_ids" colspan="4"/>

                </form>
            </field>
        </record>

        <record id="clouder_settings" model='clouder.config.settings'>
            <field name="name">Clouder Settings</field>
        </record>

        <record id="action_clouder_configuration" model="ir.actions.act_window">
            <field name="name">Configure Clouder</field>
            <field name="res_model">clouder.config.settings</field>
            <field name="view_id" ref="view_clouder_configuration"/>
            <field name="view_mode">form</field>
            <field name="res_id" ref="clouder_settings"/>
        </record>

        <menuitem id="menu_clouder_admin_configuration" parent="menu_clouder_configuration"
            sequence="15" action="action_clouder_configuration"/>

        <record id="backup_clouder_daily_scheduler" model="ir.cron">
          <field name="name">Clouder Daily Cron</field>
          <field eval="1" name="interval_number"/>
          <field name="interval_type">days</field>
          <field eval="-1" name="numbercall"/>
          <field eval="0" name="doall"/>
          <field name="model">clouder.config.settings</field>
          <field name="function">cron_daily</field>
          <field name="args">([1])</field>
        </record>

        <record id="backup_clouder_nextbackups_scheduler" model="ir.cron">
          <field name="name">Clouder Next Backups</field>
          <field eval="30" name="interval_number"/>
          <field name="interval_type">minutes</field>
          <field eval="-1" name="numbercall"/>
          <field eval="0" name="doall"/>
          <field name="model">clouder.config.settings</field>
          <field name="function">launch_next_backups</field>
          <field name="args">([1])</field>
        </record>

    </data>
</odoo>
